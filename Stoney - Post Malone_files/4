(function(){var jQuery;var needtoLoad=false;if(window.jQuery===undefined){needtoLoad=true;}else{version=window.jQuery.fn.jquery.split('.');if(parseInt(version[0])<2){if(parseInt(version[0])<1)needtoLoad=true;if(parseInt(version[0])==1&&parseInt(version[1])<7)needtoLoad=true;}}
if(needtoLoad){var script_tag=document.createElement('script');script_tag.setAttribute('type','text/javascript');script_tag.setAttribute('src','https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js');if(script_tag.readyState){script_tag.onreadystatechange=function(){if(this.readyState=='complete'||this.readyState=='loaded'){scriptLoadHandler();}};}else{script_tag.onload=scriptLoadHandler;}
(document.getElementsByTagName('head')[0]||document.documentElement).appendChild(script_tag);}else{jQuery=window.jQuery;main();}
function scriptLoadHandler(){jQuery=window.jQuery.noConflict(true);main();}
function main(){jQuery(document).ready(function($){if(typeof console==='undefined')console={log:function(){}};var div=document.createElement("div");div.innerHTML="<!--[if lt IE 10]><i></i><![endif]-->";var isIeLessThan10=(div.getElementsByTagName("i").length==1);if(isIeLessThan10){var httpRegEx=/^(https?:)?\/\//i;var getOrPostRegEx=/^get|post$/i;var sameSchemeRegEx=new RegExp('^(\/\/|'+ location.protocol+')','i');$.ajaxTransport('* text html xml json',function(options,userOptions,jqXHR){if(!options.crossDomain||!options.async||!getOrPostRegEx.test(options.type)||!httpRegEx.test(options.url)||!sameSchemeRegEx.test(options.url)){return;}
var xdr=null;return{send:function(headers,complete){var postData='';var userType=(userOptions.dataType||'').toLowerCase();xdr=new XDomainRequest();if(/^\d+$/.test(userOptions.timeout)){xdr.timeout=userOptions.timeout;}
xdr.ontimeout=function(){complete(500,'timeout');};xdr.onload=function(){var allResponseHeaders='Content-Length: '+ xdr.responseText.length+'\r\nContent-Type: '+ xdr.contentType;var status={code:200,message:'success'};var responses={text:xdr.responseText};try{if(userType==='html'||/text\/html/i.test(xdr.contentType)){responses.html=xdr.responseText;}else if(userType==='json'||(userType!=='text'&&/\/json/i.test(xdr.contentType))){try{responses.json=$.parseJSON(xdr.responseText);}catch(e){status.code=500;status.message='parseerror';}}else if(userType==='xml'||(userType!=='text'&&/\/xml/i.test(xdr.contentType))){var doc=new ActiveXObject('Microsoft.XMLDOM');doc.async=false;try{doc.loadXML(xdr.responseText);}catch(e){doc=undefined;}
if(!doc||!doc.documentElement||doc.getElementsByTagName('parsererror').length){status.code=500;status.message='parseerror';throw'Invalid XML: '+ xdr.responseText;}
responses.xml=doc;}}catch(parseMessage){throw parseMessage;}finally{complete(status.code,status.message,responses,allResponseHeaders);}};xdr.onprogress=function(){};xdr.onerror=function(){complete(500,'error',{text:xdr.responseText});};if(userOptions.data){postData=($.type(userOptions.data)==='string')?userOptions.data:$.param(userOptions.data);}
xdr.open(options.type,options.url);xdr.send(postData);},abort:function(){if(xdr){xdr.abort();}}};});}
$.fn.extend({omniWindow:function(options){options=$.extend(true,{animationsPriority:{show:['overlay','modal'],hide:['modal','overlay']},overlay:{selector:'.ow-overlay',hideClass:'ow-closed',animations:{show:function(subjects,internalCallback){return internalCallback(subjects);},hide:function(subjects,internalCallback){return internalCallback(subjects);},internal:{show:function(subjects){subjects.overlay.removeClass(options.overlay.hideClass);},hide:function(subjects){subjects.overlay.addClass(options.overlay.hideClass);}}}},modal:{hideClass:'ow-closed',animations:{show:function(subjects,internalCallback){return internalCallback(subjects);},hide:function(subjects,internalCallback){return internalCallback(subjects);},internal:{show:function(subjects){subjects.modal.removeClass(options.modal.hideClass);},hide:function(subjects){subjects.modal.addClass(options.modal.hideClass);}}},internal:{stateAttribute:'ow-active'}},eventsNames:{show:'show.ow',hide:'hide.ow',internal:{overlayClick:'click.ow',keyboardKeyUp:'keyup.ow'}},callbacks:{beforeShow:function(subjects,internalCallback){return internalCallback(subjects);},positioning:function(subjects,internalCallback){return internalCallback(subjects);},afterShow:function(subjects,internalCallback){return internalCallback(subjects);},beforeHide:function(subjects,internalCallback){return internalCallback(subjects);},afterHide:function(subjects,internalCallback){return internalCallback(subjects);},internal:{beforeShow:function(subjects){if(subjects.modal.data(options.modal.internal.stateAttribute)){return false;}else{subjects.modal.data(options.modal.internal.stateAttribute,true);return true;}},afterShow:function(subjects){$(document).on(options.eventsNames.internal.keyboardKeyUp,function(e){if(e.keyCode===27){subjects.modal.trigger(options.eventsNames.hide);subjects.overlay.css('display','');subjects.modal.css('display','');}});subjects.overlay.on(options.eventsNames.internal.overlayClick,function(){subjects.modal.trigger(options.eventsNames.hide);subjects.overlay.css('display','');subjects.modal.css('display','');});},positioning:function(subjects){subjects.modal.css('margin-left',Math.round(subjects.modal.outerWidth(false)/ -2));
},beforeHide:function(subjects){if(subjects.modal.data(options.modal.internal.stateAttribute)){subjects.modal.data(options.modal.internal.stateAttribute,false);return true;}else{return false;}},afterHide:function(subjects){subjects.overlay.off(options.eventsNames.internal.overlayClick);$(document).off(options.eventsNames.internal.keyboardKeyUp);subjects.overlay.css('display','');subjects.modal.css('display','');}}}},options);var animate=function(process,subjects,callbackName){var first=options.animationsPriority[process][0],second=options.animationsPriority[process][1];options[first].animations[process](subjects,function(subjs){options[first].animations.internal[process](subjs);options[second].animations[process](subjects,function(subjs){options[second].animations.internal[process](subjs);options.callbacks[callbackName](subjects,options.callbacks.internal[callbackName]);});});};var showModal=function(subjects){if(!options.callbacks.beforeShow(subjects,options.callbacks.internal.beforeShow)){return;}
options.callbacks.positioning(subjects,options.callbacks.internal.positioning);animate('show',subjects,'afterShow');};var hideModal=function(subjects){if(!options.callbacks.beforeHide(subjects,options.callbacks.internal.beforeHide)){return;}
animate('hide',subjects,'afterHide');};var $overlay=$(options.overlay.selector);return this.each(function(){var $modal=$(this);var subjects={modal:$modal,overlay:$overlay};$modal.bind(options.eventsNames.show,function(){showModal(subjects);}).bind(options.eventsNames.hide,function(){hideModal(subjects);});});}});var css_link=jQuery('<link>',{rel:'stylesheet',type:'text/css',href:'https://umg.theappreciationengine.com//themes/appreciationengine20/auth_framework/jquery.omniwindow.css'});css_link.appendTo('head');$.support.cors
$.ajaxSetup({crossDomain:true,xhrFields:{withCredentials:true}});function topZIndex(selector){return Math.max(0,Math.max.apply(null,$.map(((selector||'*')==='*')?$.makeArray(document.getElementsByTagName('*')):$(selector),function(v){return parseFloat($(v).css('z-index'))||null;})));}
function GetURLParameter(sParam){var sPageURL=window.location.search.substring(1);var sURLVariables=sPageURL.split('&');for(var i=0;i<sURLVariables.length;i++){var sParameterName=sURLVariables[i].split('=');if(sParameterName[0]==sParam){return sParameterName[1];}}}
function addParam(url,param,value){var a=document.createElement('a'),regex=/[?&]([^=]+)=([^&]*)/g;var match,str=[];a.href=url;value=value||'';while(match=regex.exec(a.search))
if(encodeURIComponent(param)!=match[1])str.push(match[1]+'='+ match[2]);str.push(encodeURIComponent(param)+'='+ encodeURIComponent(value));a.search=(a.search.substring(0,1)=='?'?'':'?')+ str.join('&');return a.href;}
function setLinkState(active){active=typeof active!=='undefined'?active:false;if(active){$('[data-ae-register-window], [data-ae-login-window], [data-ae-logout-link], [data-ae-register-link], [data-ae-auth-link], [data-ae-login-link]').addClass('ae-active');}else{$('[data-ae-register-window], [data-ae-login-window], [data-ae-logout-link], [data-ae-register-link], [data-ae-auth-link], [data-ae-login-link]').removeClass('ae-active');}}
function nextSteps(auth_state){aeJS.user=typeof auth_state.user!=='undefined'?auth_state.user:{};var login_type=auth_state['registration']===true?'registration':'login';var missing=false;switch(auth_state.state){case'close':aeJS.events.onWindow.removeHandler(aeJS.self_destruct);aeJS.modal.window.trigger('hide');if(typeof auth_state.user!=='undefined'&&!$.isEmptyObject(auth_state.user)){if(isValidLogin())aeJS.events.onLogin.callHandler(auth_state.user,login_type);}
break;case'register':var done=true;if(aeJS.settings['extra_fields_screen']==='after'){if(login_type==='registration'){missing=extraFields(aeJS.user);if(missing===false)missing={};if(auth_state.service==='email'&&typeof aeJS.settings['extra_fields']!=='undefined'&&typeof aeJS.settings['extra_fields']['username']!=='undefined'){$.extend(missing,{'username':{required:true}});}
if($.isEmptyObject(missing))missing=false;}else{missing=extraFields(aeJS.user,true);}
if(missing!==false){done=false;aeJS.settings.extra_fields=missing;aeJS.self_destruct=function(e){if(e.type==='modal'&&e.state==='closed'){if(isValidLogin())aeJS.events.onLogin.callHandler(auth_state.user,'registration');aeJS.events.onWindow.removeHandler(aeJS.self_destruct);}}
aeJS.events.onWindow.addHandler(aeJS.self_destruct);aeJS.flow.step='required-fields';aeJS.flow.auth_url=auth_state.auth_url;aeJS.flow.return=(auth_state.return==='undefined')?aeJS.flow.return:auth_state.return;aeJS.events.onFlow.callHandler(aeJS.flow);break;}}
if(JSON.parse(aeJS.settings['verify_email'])===true&&!verifiedEmail()){if(typeof auth_state.verified==='undefined'||JSON.parse(auth_state.verified)!==true){done=false;aeJS.flow.step='verify-email';aeJS.flow.return=(auth_state.return==='undefined')?aeJS.flow.return:auth_state.return;aeJS.events.onFlow.callHandler(aeJS.flow);break;}}
if(done===true){auth_state.state='close';if(aeJS.isEmbed){if(self!=top&&isValidLogin())aeJS.events.onLogin.callHandler(auth_state.user,login_type);else parent.postMessage(JSON.stringify(auth_state),auth_state.referer);}else{aeJS.modal.window.trigger('hide');if(isValidLogin()){aeJS.events.onLogin.callHandler(auth_state.user,login_type);}else{var reason=isValidLogin(true);done=false;aeJS.flow.step=reason;aeJS.flow.return=(auth_state.return==='undefined')?aeJS.flow.return:auth_state.return;aeJS.events.onFlow.callHandler(aeJS.flow,false);break;}}}
break;case'update':if(aeJS.settings['verify_email']===true&&!verifiedEmail()){aeJS.flow.step='verify-email';aeJS.flow.return=(auth_state.return==='undefined')?aeJS.flow.return:auth_state.return;aeJS.events.onFlow.callHandler(aeJS.flow);}else{auth_state.state='close';if(aeJS.isEmbed){if(self!=top&&isValidLogin())aeJS.events.onLogin.callHandler(auth_state.user,login_type);else parent.postMessage(JSON.stringify(auth_state),auth_state.auth_referer);}else{aeJS.events.onWindow.removeHandler(aeJS.self_destruct);aeJS.modal.window.trigger('hide');aeJS.events.onLogin.callHandler(auth_state.user,login_type);}}
break;case'token_login':if(isValidLogin()){aeJS.events.onUser.callHandler(auth_state.user,'init');}else{if(isValidSSO()){var sso=SSO()
if(sso!==false){$.post('https://umg.theappreciationengine.com/framework/sso/4',{service_id:sso,domain:'www.postmalone.com'},function(auth_state){if(typeof auth_state.user!=='undefined')aeJS.user=auth_state.user;if(isValidLogin())aeJS.events.onLogin.callHandler(auth_state.user,'registration',true);});}}}
break;case'complete':case'login':auth_state.state='close';if(aeJS.isEmbed){if(self!=top&&isValidLogin())aeJS.events.onLogin.callHandler(auth_state.user,login_type);else parent.postMessage(JSON.stringify(auth_state),auth_state.auth_referer);}else{aeJS.modal.window.trigger('hide');if(isValidLogin()){aeJS.events.onLogin.callHandler(auth_state.user,login_type);}else{var reason=isValidLogin(true);done=false;aeJS.flow.step=reason;aeJS.flow.return=(auth_state.return==='undefined')?aeJS.flow.return:auth_state.return;aeJS.events.onFlow.callHandler(aeJS.flow,false);break;}}
break;case'auth':auth_state.state='close';if(aeJS.isEmbed){if(self!=top&&isValidLogin())aeJS.events.onLogin.callHandler(auth_state.user,login_type);else parent.postMessage(JSON.stringify(auth_state),auth_state.auth_referer);}else{aeJS.modal.window.trigger('hide');aeJS.events.onLogin.callHandler(auth_state.user,'auth');}
break;case'passthrough':if(typeof auth_state.event!=='undefined'){aeJS.flow=auth_state.event;aeJS.events.onFlow.callHandler(aeJS.flow,false);}
break;case'error':aeJS.flow.step='error';if(typeof auth_state.error.code!='undefined')aeJS.flow.code=auth_state.error.code;if(typeof auth_state.error.message!='undefined')aeJS.flow.error=auth_state.error.message;aeJS.flow.return=(auth_state.return==='undefined')?aeJS.flow.return:auth_state.return;aeJS.events.onFlow.callHandler(aeJS.flow);break;}}
var eventMethod=window.addEventListener?'addEventListener':'attachEvent';var eventer=window[eventMethod];var messageEvent=eventMethod=='attachEvent'?'onmessage':'message';var messageHandled=false;eventer(messageEvent,function(e){if(e.origin!=='https://umg.theappreciationengine.com'){return;}else{var auth_state=JSON.parse(e.data);messageHandled=true;nextSteps(auth_state);}},false);var aeJS=aeJS||{};var aeJSPrepped=false;var createNS=function(namespace){var nsparts=namespace.split('.');var parent=aeJS;if(nsparts[0]==='aeJS'){nsparts=nsparts.slice(1);}
for(var i=0;i<nsparts.length;i++){var partname=nsparts[i];if(typeof parent[partname]==='undefined'){parent[partname]={};}
parent=parent[partname];}
return parent;};createNS('aeJS.settings');var default_settings={'mobile_detect':true,'close_button':false,'hide_email_form':false,'extra_fields':{},'extra_fields_screen':'disabled','display_error_message':true,'auth_window':false,'services':null,'scopes':null,'sso':'application','language':'en_US','extra_info':{},'flow_css':null,'verify_email':false,'verify_email_for_login':false,'code':null,'no_email':false,'social_first':false,'refresh_demographics':true,'minimum_age':null,'date_format':'DD-MM-YYYY','profile_link':null,'partner_code':null,'partner_id':null,'help_link':null,'flow_text':{error_header:'Sorry, there seems to be a problem',login_header:'Sign In',login_button:'Sign In',login_with_button:'Sign in with',register_header:'Sign Up',register_button:'Sign Up',register_with_button:'Sign up with',add_info_header:'Additional Information',add_info_button:'Submit',reset_pw_header:'Reset Password',reset_pw_sent:'A verification email will be sent to',reset_pw_instructions:'Please click the link in the email to confirm your address and reset your password.',reset_pw_button:'Verify Email',reset_pw_confirm_header:'Reset Password - Confirm',reset_pw_confirm_button:'Confirm',reset_pw_confirm_instructions:'Please enter a new password',reset_pw_done_header:'Reset Password - Done!',reset_pw_done_message:'Your password has been reset.',reset_pw_done_button:'OK',verify_email_header:'Verify Email',verify_email_sent:'A verification email will be sent to',verify_email_instructions:'Please click the link in the email to confirm your address and continue.',verify_email_retry_button:'Retry',verify_email_success_header:'Success.',verify_email_success_message:'Your email was successfully verified.',verify_email_success_button:'OK',verify_email_error_header:'Sorry.',verify_email_error_message:'That is not a valid activation url, or the url has expired. Please double check your email, or trigger a new activation email.',forgot_password_link:'forgot password?',recover_password_link:'Recover Password',optins_title:'Subscribe to these mailing lists',have_account_link:'Have an account?',need_help_link:'need help?',create_account_link:'create an account'},email_format:{show_header:true,show_footer:true,reset_pw_email_subject:'Password Reset For UMG',reset_pw_email_message:'Click the following link to verify your email and reset your password',reset_pw_email_link:'Reset Password',verify_email_subject:'Please verify your email address for UMG',verify_email_message:'Click the following link to verify your email and continue with your registration',verify_email_link:'Verify Email',}};createNS('aeJS.user');createNS('aeJS.flow');createNS('aeJS.isEmbed');aeJS.isEmbed=window!=window.parent;createNS('aeJS.events');aeJS.events.onFlow={};aeJS.events.onWindow={};aeJS.events.onLogin={};aeJS.events.onLogout={};aeJS.events.onUser={};aeJS.events.onMobileDetect={};aeJS.events.onServiceRemoved={};aeJS.events.onLoaded={};aeJS.events.onEmailVerify={};aeJS.events.onPasswordReset={};aeJS.events.onActivitySent={};var aeEvent=function(){var listeners=[];this.getListeners=function(){return listeners;};this.addHandler=function(callback){listeners.push(callback);};this.removeHandler=function(callback){for(var i=0;i<listeners.length;i++){if(listeners[i]===callback){listeners.splice(i,1);}}};this.callHandler=function(){var len=listeners.length;var i;for(i=0;i<len;++i){listeners[i].apply(null,arguments);}};};aeEvent.call(aeJS.events.onFlow);aeEvent.call(aeJS.events.onWindow);aeEvent.call(aeJS.events.onLogin);aeEvent.call(aeJS.events.onLogout);aeEvent.call(aeJS.events.onMobileDetect);aeEvent.call(aeJS.events.onUser);aeEvent.call(aeJS.events.onServiceRemoved);aeEvent.call(aeJS.events.onLoaded);aeEvent.call(aeJS.events.onEmailVerify);aeEvent.call(aeJS.events.onActivitySent);aeEvent.call(aeJS.events.onPasswordReset);$.extend(aeJS.events.onFlow,{clickHandler:function(event){if(typeof event.preventDefault!=='undefined')event.preventDefault();if(aeJSPrepped){aeJS.flow=$.extend({},event.data);if(!$(event.target).data('aeReturn')&&typeof aeJS.settings['return_url']!=='undefined')
aeJS.flow.return=aeJS.settings['return_url'];if(aeJS.flow.step!='logout'&&aeJS.flow.step!='remove'){if(aeJS.flow.step=='login'||aeJS.flow.step=='register'){if(aeJS.settings['auth_window']===true&&!parseInt()){var isSafari=navigator.vendor&&navigator.vendor.indexOf('Apple')>-1;if(isSafari){openAuthWindow({path:'https://umg.theappreciationengine.com/framework/session_start/4',windowOptions:'location=0,status=0,width=5,height=5',callback:function(){window.focus();}});}}}
if(typeof aeJS.settings['extra_fields_screen_original']!=='undefined'){aeJS.settings['extra_fields_screen']=aeJS.settings['extra_fields_screen_original'];}
if(aeJS.flow.step=='login'||aeJS.flow.step=='login-direct'){if(typeof aeJS.settings['extra_fields_screen_original']==='undefined'){aeJS.settings=$.extend(aeJS.settings,{'extra_fields_screen_original':aeJS.settings['extra_fields_screen']});}
aeJS.settings['extra_fields_screen']='disabled';}
if(aeJS.flow.step=='login-direct'||aeJS.flow.step=='register-direct'){aeJS.flow.step='authenticate';if(aeJS.settings['extra_fields_screen']=='before')aeJS.flow.step='required-fields';}}
aeJS.events.onFlow.callHandler(aeJS.flow);}}});var getAuthState=function(){$.ajax({url:'https://umg.theappreciationengine.com//framework/auth_state/4',dataType:'JSONP',type:'GET',success:function(auth_state){var login_type=auth_state['registration']===true?'registration':'login';aeJS.user=typeof auth_state.user!=='undefined'?auth_state.user:{};if(isValidLogin())aeJS.events.onLogin.callHandler(aeJS.user,login_type);}});}
var openAuthWindow=function(options){messageHandled=false;options.windowName=options.windowName||'ae_auth_window';options.windowOptions=options.windowOptions||'location=0,status=0,width=600,height=600';options.callback=options.callback||function(){window.location.reload();};options.windowOptions=options.windowOptions+',scrollbars=1'
options.path=addParam(options.path,'auth_method','window');if(typeof aeJS.authInterval!=='undefined')window.clearInterval(aeJS.authInterval);aeJS.auth_window=window.open(options.path,options.windowName,options.windowOptions);if(window.focus&&typeof aeJS.auth_window!=='undefined'){aeJS.auth_window.focus();}
aeJS.authInterval=window.setInterval(function(){if(aeJS.auth_window&&aeJS.auth_window.closed){window.clearInterval(aeJS.authInterval);options.callback({'type':'popup','state':'closed','service':aeJS.flow.service});}},1000);options.callback({'type':'popup','state':'opened','service':aeJS.flow.service});return false;};var authenticate=function(auth_url){auth_url=addParam(auth_url,'referer','http://www.postmalone.com/');auth_url=addParam(auth_url,'partner_id',aeJS.settings['partner_id']);auth_url=addParam(auth_url,'partner_code',aeJS.settings['partner_code']);var optins='';$('input[data-ae-optin],input[data-ae-optin-brandid],input[data-ae-optin-segmentid]').each(function(index){var brandid=$(this).data('aeOptinBrandid');var segmentid=$(this).data('aeOptinSegmentid');var label=$(this).data('aeOptin');if($(this).prop('checked')){optins=optins+ brandid+':'+ segmentid+':'+ label+',';}
auth_url=addParam(auth_url,'optins',optins);});if((JSON.parse(aeJS.settings['auth_window'])===true)&&(!parseInt()||!aeJS.settings['mobile_detect'])){var popupWidth=600;var popupHeight=450;var xPosition=($(window).width()-popupWidth)/2;
var yPosition=($(window).height()-popupHeight)/2;
openAuthWindow({path:auth_url,windowOptions:'width='+popupWidth+',height='+popupHeight+',left='+xPosition+',top='+yPosition,callback:aeJS.events.onWindow.callHandler});}else{if(aeJS.isEmbed){auth_url=addParam(auth_url,'referer','http://www.postmalone.com/');auth_url=addParam(auth_url,'return',document.referrer);window.top.location.href=auth_url;}else{location.href=auth_url;}}};var checkVerifyEmail=function(){if(aeJS.settings['verify_email']===true){var noUserEmail=false;if(typeof aeJS.user.data==='undefined'||aeJS.user.data.Email===null)noUserEmail=true;if(noUserEmail&&typeof aeJS.settings['extra_fields']['email']==='undefined'){$.extend(aeJS.settings['extra_fields'],{'email':{required:true}});}
if(aeJS.settings['extra_fields_screen']==='disabled'){aeJS.settings['extra_fields_screen']='after'}}};var extraFields=function(user,requiredOnly){var is_missing=false;var missing={};if(typeof requiredOnly==='undefined')requiredOnly=false;if(typeof aeJS.settings['extra_fields']!='undefined'){if(typeof user.data!='undefined'){var key,keys=Object.keys(user.data);var n=keys.length;var user_data_lc={}
while(n--){key=keys[n];user_data_lc[key.toLowerCase()]=user.data[key];}
$.each(aeJS.settings['extra_fields'],function(field,properties){var extra_field=aeJS.settings['extra_fields'][field];var required=(typeof extra_field.required!=='undefined'&&JSON.parse(extra_field.required)===true);if(!requiredOnly||(required&&requiredOnly)){if(typeof user_data_lc[field]==='undefined'||user_data_lc[field]==='Unknown'||(!!user_data_lc[field])===false){is_missing=true;missing[field]=properties;}}});}else{return aeJS.settings['extra_fields'];}}
if(is_missing)return missing;return is_missing;};var initSettings=function(){var temp_settings=$.extend(true,default_settings,aeJS.settings);aeJS.settings=temp_settings;if(typeof aeJS.settings['extra_fields']['password']!=='undefined'){aeJS.settings['password_format']=aeJS.settings['extra_fields']['password'];delete aeJS.settings['extra_fields']['password'];}};var verifiedEmail=function(){var verified=false;if(typeof aeJS.user.data!='undefined'){if(typeof aeJS.user.data.VerifiedEmail!=='undefined'&&aeJS.user.data.VerifiedEmail!==null)verified=true;}
return verified;};var validService=function(){var valid_service=false;if(typeof aeJS.user.services!='undefined'){$.each(aeJS.user.services,function(index,service){if(service['Service']=='email'){if(typeof aeJS.settings['no_email']==='undefined'||JSON.parse(aeJS.settings['no_email'])===false){if($.inArray('www.postmalone.com',service['Domains'])!==-1||$.inArray('www.postmalone.com'.replace('www.',''),service['Domains'])!==-1){valid_service=true;}}}
if(typeof aeJS.settings['services']==='undefined'||aeJS.settings['services']===null||aeJS.settings['services'].indexOf(service['Service'])!==-1){if($.inArray('www.postmalone.com',service['Domains'])!==-1||$.inArray('www.postmalone.com'.replace('www.',''),service['Domains'])!==-1){valid_service=true;}}});}
return valid_service;};var SSO=function(){var sso=false;var valid_services=[135,137,139,141,143,157,158,355,362,363,377,378,393,394,519,520,2332,2333];if(typeof aeJS.user.services!='undefined'){$.each(aeJS.user.services,function(index,service){if(sso!==false)return sso;if($.inArray('www.postmalone.com',service['Domains'])!==-1||$.inArray('www.postmalone.com'.replace('www.',''),service['Domains'])!==-1){return sso;}else{if(typeof aeJS.settings['sso']==='undefined'||aeJS.settings['sso']=='application'){if(service['Service']=='email'){if(typeof aeJS.settings['no_email']==='undefined'||JSON.parse(aeJS.settings['no_email'])===false){sso=service['ID'];return;}}
if($.inArray(JSON.parse(service['ServiceID']),valid_services)!==-1){if(typeof aeJS.settings['services']==='undefined'||aeJS.settings['services']===null||aeJS.settings['services'].indexOf(service['Service'])!==-1){sso=service['ID'];return;}}}}});}
return sso;};var isValidLogin=function(returnStep){if(typeof returnStep==='undefined')returnStep=false;var valid=true;if(aeJS.settings['verify_email_for_login']===true){if(!verifiedEmail()){valid='verify-email'}}
missing=extraFields(aeJS.user,true);if(missing!==false){valid='required-fields';}
if(!validService()){valid='start';}
if(returnStep)return valid;return(valid===true);};var isValidSSO=function(){var valid=true;if(aeJS.settings['verify_email_for_login']===true){if(!verifiedEmail()){valid=false;}}
missing=extraFields(aeJS.user,true);if(missing!==false){valid=false;}
return valid;};var absolutePath=function(href){var link=document.createElement('a');link.href=href;var pathname=(link.pathname.charAt(0)=='/')?link.pathname:'/'+ link.pathname;return(link.protocol+'//'+link.host+pathname+link.search+link.hash);}
createNS('aeJS.trigger');aeJS.trigger.login=function(token){authUrl='https://umg.theappreciationengine.com//framework/auth_state/4/'+token;authUrl=addParam(authUrl,'ae_token_login',1);alert(authUrl);$.ajax({url:authUrl,dataType:'JSONP',type:'GET',success:function(auth_state){try{state=JSON.parse(auth_state)}catch(e){state=auth_state}
nextSteps(state);}});}
aeJS.trigger.logout=function(){aeJSPrepped=false;var url='https://umg.theappreciationengine.com/brand/umg/logout';url=addParam(url,'ae_appid','2');url=addParam(url,'auth_method','window');$.post(url,aeJS.settings,function(data){flowURL='https://umg.theappreciationengine.com/framework/flow/4/prep';var cache_url=addParam(flowURL,'pre_cache',1);var cache_url=addParam(cache_url,'from','b85474c18298ed0a9398a4488659f2c1');$.post(cache_url,aeJS.settings,function(data){aeJSPrepped=true;aeJS.events.onLogout.callHandler({});});});}
aeJS.trigger.remove=function(service,returnURL){var removeURLs={"facebook":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/135","youtube":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/137","twitter":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/139","foursquare":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/141","soundcloud":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/143","tumblr":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/157","instagram":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/158","email":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/355","google":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/362","spotify":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/363","deezer":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/377","rdio":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/378","lastfm":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/394","weibo":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/519","qq":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/520","napster":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/2332","kakao":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/2333"};var step='remove';if(typeof(returnURL)=='undefined')returnURL=location.href
if(typeof(service)!=='undefined'){url=removeURLs[service];var event=jQuery.Event('click');$.extend(event,{target:{}});$(event.target).attr('data-ae-return',returnURL);$.extend(true,event,{data:{'step':step,'auth_url':url,'return':returnURL}});aeJS.events.onFlow.clickHandler(event);}}
aeJS.trigger.authenticate=function(service,type,returnURL){var loginURLs={"facebook":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/135","youtube":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/137","twitter":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/139","foursquare":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/141","soundcloud":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/143","tumblr":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/157","instagram":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/158","email":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/355","google":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/362","spotify":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/363","deezer":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/377","rdio":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/378","lastfm":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/394","weibo":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/519","qq":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/520","napster":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/2332","kakao":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/2333"};var registerURLs={"facebook":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/135","youtube":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/137","twitter":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/139","foursquare":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/141","soundcloud":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/143","tumblr":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/157","instagram":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/158","email":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/355","google":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/362","spotify":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/363","deezer":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/377","rdio":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/378","lastfm":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/394","weibo":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/519","qq":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/520","napster":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/2332","kakao":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/2333"};var authURLs={"facebook":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/135","youtube":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/137","twitter":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/139","foursquare":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/141","soundcloud":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/143","tumblr":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/157","instagram":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/158","email":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/355","google":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/362","spotify":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/363","deezer":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/377","rdio":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/378","lastfm":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/394","weibo":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/519","qq":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/520","napster":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/2332","kakao":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/2333"};var step='';var url='';if(typeof(returnURL)=='undefined')returnURL=location.href
if(typeof(type)==='undefined')type='register';if(type=='login'){step='login-direct';url=loginURLs[service];}else if(type=='register'){step='register-direct';url=registerURLs[service];}else if(type=='auth'){step='authenticate';url=authURLs[service];}
var event=jQuery.Event('click');$.extend(event,{target:{}});$(event.target).attr('data-ae-return',returnURL);$.extend(true,event,{data:{'step':step,'auth_url':url,'return':returnURL,'service':service}});aeJS.events.onFlow.clickHandler(event);}
aeJS.trigger.flow=function(type,returnURL){if(typeof type==='undefined')type='register';var url='https://umg.theappreciationengine.com/framework/flow/4/'+type;var step=type;var returnURL=(typeof returnURL==='undefined')?window.location.href:returnURL;var event=jQuery.Event('click');$.extend(event,{target:{}});$(event.target).attr('data-ae-return',returnURL);$.extend(true,event,{data:{'step':step,'auth_url':url,'return':returnURL}});aeJS.events.onFlow.clickHandler(event);}
aeJS.trigger.verify_email=function(returnURL){aeJS.trigger.send_verify_email(returnURL,'','','verify-email');}
aeJS.trigger.verify_reset_password=function(returnURL){aeJS.trigger.send_verify_email(returnURL,'','','reset-password');}
aeJS.trigger.send_verify_email=function(returnURL,email,message,step){if(typeof step==='undefined')step='send-email'
if(email!=='')aeJS.settings.email=email;if(message!=='')aeJS.settings.message=message;aeJS.flow.step=step;if(typeof returnURL==='undefined'){if(typeof aeJS.settings['return_url']!=='undefined')returnURL=aeJS.settings['return_url'];else returnURL=location.href;}
aeJS.flow.return=returnURL;if(step==='send-email'){flowURL='https://umg.theappreciationengine.com/framework/flow/4/send-email';var cache_url=addParam(flowURL,'pre_cache',1);cache_url=addParam(cache_url,'from','b85474c18298ed0a9398a4488659f2c1');cache_url=addParam(cache_url,'return',absolutePath(returnURL));$.post(cache_url,aeJS.settings,function(data){if(typeof data.code!=='undefined'){aeJS.events.onEmailVerify.callHandler('error',data);}else{aeJS.events.onEmailVerify.callHandler('sent',{'EmailAddress':aeJS.settings.email,'ActivationCode':data});}});}else{aeJS.events.onFlow.callHandler(aeJS.flow);}}
aeJS.trigger.send_activity=function(id,data,marker,record){if(typeof record==='undefined')record=false;activityURL='https://umg.theappreciationengine.com/framework/send_activity/4';var data={activity_id:id,data:data,marker:marker,record:record};$.post(activityURL,data,function(response){aeJS.events.onActivitySent.callHandler(response);});}
aeJS.trigger.reset_password=function(service_id,email,password){if(typeof service_id==='undefined')error='missing service id';if(typeof email==='undefined')error='missing email';if(typeof password==='undefined')error='missing password';if(typeof error!=='undefined')aeJS.events.onPasswordReset.callHandler('error',error);flowURL='https://umg.theappreciationengine.com/framework/flow/4/reset-password-ok';var cache_url=addParam(flowURL,'pre_cache',1);var cache_url=addParam(cache_url,'from','b85474c18298ed0a9398a4488659f2c1');$.post(cache_url,{'password':password,'email':email,'member_service_id':service_id},function(data){aeJS.events.onPasswordReset.callHandler('ok');});}
aeJS.trigger.submit=function(form){if($(form).data('aeRegisterForm')!=='undefined'){$(form).submit();}}
aeJS.trigger.popup=function(url,callback){var popupWidth=600;var popupHeight=450;var xPosition=($(window).width()-popupWidth)/2;
var yPosition=($(window).height()-popupHeight)/2;
openAuthWindow({path:url,windowOptions:'width='+popupWidth+',height='+popupHeight+',left='+xPosition+',top='+yPosition,callback:aeJS.events.onWindow.callHandler});}
createNS('aeJS.get');aeJS.get.user=function(){return aeJS.user;}
aeJS.get.flow=function(){var reason=isValidLogin(true);if(reason===true)reason='done';if(typeof aeJS.settings['return_url']!=='undefined')returnURL=aeJS.settings['return_url'];else returnURL=location.href;aeJS.flow.step=reason;aeJS.flow.return=returnURL;return aeJS.flow;}
aeJS.trigger.attach=function(context){$('a[data-ae-login-window]').each(function(index){if(typeof context=='undefined'||$(context).is($(this))){var url='https://umg.theappreciationengine.com/framework/flow/4/login';var step='login';var returnURL=window.location.href;if($(this).data('aeReturn'))returnURL=$(this).data('aeReturn');$(this).off('click',aeJS.events.onFlow.clickHandler).on('click',{'step':step,'auth_url':url,return:returnURL},aeJS.events.onFlow.clickHandler);}});$('a[data-ae-register-window]').each(function(index){if(typeof context=='undefined'||$(context).is($(this))){var url='https://umg.theappreciationengine.com/framework/flow/4/register';var step='register';var returnURL=window.location.href;if($(this).data('aeReturn'))returnURL=$(this).data('aeReturn');$(this).off('click',aeJS.events.onFlow.clickHandler).on('click',{'step':step,'auth_url':url,return:returnURL},aeJS.events.onFlow.clickHandler);}});$('a[data-ae-login-link]').each(function(index){if(typeof context=='undefined'||$(context).is($(this))){var loginURLs={"facebook":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/135","youtube":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/137","twitter":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/139","foursquare":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/141","soundcloud":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/143","tumblr":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/157","instagram":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/158","email":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/355","google":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/362","spotify":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/363","deezer":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/377","rdio":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/378","lastfm":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/394","weibo":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/519","qq":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/520","napster":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/2332","kakao":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/2333"};var service=$(this).data('aeLoginLink');var url=loginURLs[service];var step='login-direct';var returnURL=window.location.href;if(service==='email')step='login-direct-email';if($(this).data('aeReturn'))returnURL=$(this).data('aeReturn');if($(this).data('aeStep'))step=$(this).data('aeStep');$(this).off('click',aeJS.events.onFlow.clickHandler).on('click',{'step':step,'auth_url':url,'return':returnURL,'service':service},aeJS.events.onFlow.clickHandler);}});$('a[data-ae-register-link]').each(function(index){if(typeof context=='undefined'||$(context).is($(this))){var registerURLs={"facebook":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/135","youtube":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/137","twitter":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/139","foursquare":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/141","soundcloud":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/143","tumblr":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/157","instagram":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/158","email":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/355","google":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/362","spotify":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/363","deezer":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/377","rdio":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/378","lastfm":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/394","weibo":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/519","qq":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/520","napster":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/2332","kakao":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/2333"};var service=$(this).data('aeRegisterLink');var url=registerURLs[service];var step='register-direct';var returnURL=window.location.href;if(service==='email')step='register-direct-email';if($(this).data('aeReturn'))returnURL=$(this).data('aeReturn');if($(this).data('aeStep'))step=$(this).data('aeStep');$(this).off('click',aeJS.events.onFlow.clickHandler).on('click',{'step':step,'auth_url':url,'return':returnURL,'service':service},aeJS.events.onFlow.clickHandler);}});$('a[data-ae-logout-link]').each(function(index){if(typeof context=='undefined'||$(context).is($(this))){var step='logout';var returnURL=window.location.href;var url='https://umg.theappreciationengine.com/brand/umg/logout';if($(this).data('aeReturn'))returnURL=$(this).data('aeReturn');$(this).off('click',aeJS.events.onFlow.clickHandler).on('click',{'step':step,'auth_url':url,return:returnURL},aeJS.events.onFlow.clickHandler);}});$('a[data-ae-auth-link]').each(function(index){if(typeof context=='undefined'||$(context).is($(this))){var authURLs={"facebook":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/135","youtube":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/137","twitter":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/139","foursquare":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/141","soundcloud":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/143","tumblr":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/157","instagram":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/158","email":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/355","google":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/362","spotify":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/363","deezer":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/377","rdio":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/378","lastfm":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/394","weibo":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/519","qq":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/520","napster":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/2332","kakao":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/auth\/2333"};var service=$(this).data('aeAuthLink');var url=authURLs[service];var step='authenticate';var returnURL=window.location.href;if(service==='email')step='auth-direct-email';if($(this).data('aeReturn'))returnURL=$(this).data('aeReturn');if($(this).data('aeStep'))step=$(this).data('aeStep');$(this).off('click',aeJS.events.onFlow.clickHandler).on('click',{'step':step,'auth_url':url,'return':returnURL,'service':service},aeJS.events.onFlow.clickHandler);}});$('a[data-ae-remove-link]').each(function(index){if(typeof context=='undefined'||$(context).is($(this))){var removeURLs={"facebook":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/135","youtube":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/137","twitter":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/139","foursquare":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/141","soundcloud":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/143","tumblr":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/157","instagram":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/158","email":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/355","google":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/362","spotify":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/363","deezer":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/377","rdio":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/378","lastfm":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/394","weibo":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/519","qq":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/520","napster":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/2332","kakao":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/remove\/2333"};var service=$(this).data('aeRemoveLink');var url=removeURLs[service];var step='remove';var returnURL=window.location.href;if($(this).data('aeReturn'))returnURL=$(this).data('aeReturn');if($(this).data('aeStep'))step=$(this).data('aeStep');$(this).off('click',aeJS.events.onFlow.clickHandler).on('click',{'step':step,'auth_url':url,'return':returnURL,'service':service},aeJS.events.onFlow.clickHandler);}});$('a[data-ae-link]').each(function(index){if(typeof context=='undefined'||$(context).is($(this))){var step=$(this).data('aeLink');var url='https://umg.theappreciationengine.com/framework/flow/4/'+ step;if($(this).data('aeReturn'))returnURL=$(this).data('aeReturn');else returnURL=location.href;$(this).off('click',aeJS.events.onFlow.clickHandler).on('click',{'step':step,'auth_url':url,return:returnURL},aeJS.events.onFlow.clickHandler);}});$('input[data-ae-optin],input[data-ae-optin-brandid],input[data-ae-optin-segmentid]').each(function(index){if($(this).data('aeOptin'))$(this).after('<label class=\'ae-optin-label\'>'+ $(this).data('aeOptin')+'</label>');});$('form[data-ae-register-form]').each(function(index){if(typeof context=='undefined'||$(context).is($(this))){function formSubmit(event){event.preventDefault();if(parseInt()===1&&aeJS.settings['mobile_detect'])aeJS.settings['auth_window']=false;var loginType='register';if($(this).data('aeType'))var loginType=$(this).data('aeType');var service=$(this).attr('data-ae-register-form');if(loginType=='register'){var registerURLs={"facebook":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/135","youtube":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/137","twitter":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/139","foursquare":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/141","soundcloud":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/143","tumblr":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/157","instagram":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/158","email":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/355","google":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/362","spotify":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/363","deezer":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/377","rdio":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/378","lastfm":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/394","weibo":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/519","qq":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/520","napster":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/2332","kakao":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/register\/2333"};var url=registerURLs[service];var step='register-direct';}else{var loginURLs={"facebook":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/135","youtube":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/137","twitter":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/139","foursquare":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/141","soundcloud":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/143","tumblr":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/157","instagram":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/158","email":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/355","google":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/362","spotify":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/363","deezer":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/377","rdio":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/378","lastfm":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/394","weibo":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/519","qq":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/520","napster":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/2332","kakao":"https:\/\/umg.theappreciationengine.com\/brand\/umg\/login\/2333"};var url=loginURLs[service];var step='login-direct';}
var returnURL=window.location.href;var update=false;if($(this).data('aeReturn'))returnURL=$(this).data('aeReturn');$(this).attr('action',url);if(typeof aeJS.user.data!=='undefined'&&loginType!='login'){url=url.replace(/register|login|auth/gi,'update');update=true;}
var this_form=$(this);var method=aeJS.settings['auth_window']===true?'window':'direct';if(!$(this).data('aeReturn')&&typeof aeJS.settings['return_url']!=='undefined')
returnURL=aeJS.settings['return_url'];aeJS.flow.return=returnURL;flowURL=addParam('https://umg.theappreciationengine.com/framework/flow/4/prep','auth_url',url);flowURL=addParam(flowURL,'return',absolutePath(returnURL));flowURL=addParam(flowURL,'auth_method',method);if(update){if(typeof aeJS.user.data!='undefined'){var input=$('<input>').attr('type','hidden').attr('name','MemberID').val(aeJS.user.data.ID);$(this).append($(input));}
$.post('https://umg.theappreciationengine.com/framework/auth_state/4',$(this).serialize(),function(auth_state){aeJS.user=auth_state.user;if(isValidLogin()){aeJS.events.onUser.callHandler(auth_state.user,'update');}else{var reason=isValidLogin(true);aeJS.flow.step=reason;aeJS.flow.return=(auth_state.return==='undefined')?aeJS.flow.return:auth_state.return;aeJS.events.onFlow.callHandler(aeJS.flow,false);}});}else{if(service=='email'){if(aeJS.settings['auth_window']===true){var email_reg_url=addParam('https://umg.theappreciationengine.com/framework/email_ajax_register/4','return',absolutePath(returnURL));email_url=addParam(email_reg_url,'auth_method',method);email_url=addParam(email_reg_url,'type',loginType);$.post(email_url,$(this).serialize(),function(auth_state){nextSteps(auth_state);});}else{var input=$('<input>').attr('type','hidden').attr('name','return').val(absolutePath(returnURL));$(this).append($(input));var cache_url=addParam(flowURL,'pre_cache',1);$.post(cache_url,aeJS.settings,function(data){this_form.off('submit',formSubmit);this_form.submit();this_form.on('submit',formSubmit);});}}else{if(aeJS.settings['auth_window']===true){aeJS.trigger.popup('about:blank');$(this).prop('target',aeJS.auth_window.name);}
var input=$('<input>').attr('type','hidden').attr('name','return').val(absolutePath(returnURL));$(this).append($(input));var cache_url=addParam(flowURL,'pre_cache',1);$.post(cache_url,aeJS.settings,function(data){this_form.off('submit',formSubmit);this_form.submit();this_form.on('submit',formSubmit);});}}};$(this).on('submit',formSubmit);}});}
if(!aeJS.isEmbed){createNS('aeJS.modal');aeJS.modal.overlay=$('<div/>');aeJS.modal.overlay.attr('id','ae-modal-overlay');aeJS.modal.overlay.attr('class','ae-modal-overlay ae-modal-overlay-closed');$('body').append(aeJS.modal.overlay);aeJS.modal.window=$('<div/>');aeJS.modal.window.attr('id','ae-modal');aeJS.modal.window.attr('class','ae-modal ae-modal-closed');$('body').append(aeJS.modal.window);aeJS.modal.window.omniWindow({overlay:{selector:'.ae-modal-overlay',hideClass:'ae-modal-overlay-closed'},modal:{hideClass:'ae-modal-closed'},callbacks:{afterHide:function(subjects,internalCallback){$('#ae-flow-frame').remove();aeJS.events.onWindow.callHandler({'type':'modal','state':'closed'});return internalCallback(subjects);},afterShow:function(subjects,internalCallback){aeJS.events.onWindow.callHandler({'type':'modal','state':'opened'})
return internalCallback(subjects);}}});aeJS.modal.window.show=function(flowURL,data){aeJS.modal.overlay.css('z-index',function(index){return topZIndex()+ 1;});aeJS.modal.window.css('z-index',function(index){return topZIndex()+ 1;});flowURL=addParam(flowURL,'pre_cache',1);$.post(flowURL,data,function(data){flowURL=addParam(flowURL,'cache_key',data);aeJS.modal.window.append('<iframe id=\'ae-flow-frame\' name=\'ae-flow-frame\' src=\''+flowURL+'\' seamless=\'seamless\'/>');aeJS.modal.window.trigger('show');});};}
$('[data-ae-extra-info]').each(function(index){$(this).hide();var insert=$(this).data('aeExtraInfo');var position=($(this).data('aeExtraInfoPosition')==='undefined')?'top':$(this).data('aeExtraInfoPosition');default_settings['extra_info'][insert]={};default_settings['extra_info'][insert][position]={};default_settings['extra_info'][insert][position]['title']=$(this).children('h3').text();default_settings['extra_info'][insert][position]['text']=$(this).children('div').html();});aeJS.trigger.attach();if(typeof GetURLParameter('accessToken')!=='undefined'){token=GetURLParameter('accessToken');authUrl='https://umg.theappreciationengine.com//framework/auth_state/4/'+token;if(typeof GetURLParameter('init_token_login')!=='undefined'){if(GetURLParameter('init_token_login')=='true')authUrl=addParam(authUrl,'ae_token_login',1);}
$.ajax({url:authUrl,dataType:'JSONP',type:'GET',success:function(auth_state){try{state=JSON.parse(auth_state)}catch(e){state=auth_state}
nextSteps(state);}});};if(typeof(window.AEJSReady)=='function'){window.AEJSReady(aeJS);initSettings()
aeJS.events.onWindow.addHandler(function(data){if(data.state==='closed'&&data.type=='popup'){if(!aeJS.isEmbed&&!messageHandled){$.ajax({url:'https://umg.theappreciationengine.com//framework/auth_state/4',dataType:'JSONP',type:'GET',success:function(auth_state){nextSteps(auth_state);}});}}});aeJS.events.onLogin.addHandler(function(data,type){setLinkState(true);aeJS.user=data;});aeJS.events.onUser.addHandler(function(data,state){setLinkState(true);aeJS.user=data;});aeJS.events.onLogout.addHandler(function(data){setLinkState(false);aeJS.user=data;});aeJS.events.onMobileDetect.addHandler(function(data){});aeJS.events.onServiceRemoved.addHandler(function(service,user){});aeJS.events.onLoaded.addHandler(function(service,user){});aeJS.events.onEmailVerify.addHandler(function(service,user){});aeJS.events.onActivitySent.addHandler(function(response){});aeJS.events.onPasswordReset.addHandler(function(service,user){});aeJS.events.onFlow.addHandler(function(data,include_default){if(include_default!==false){var url=aeJS.flow.auth_url;var missing;var flowURL;checkVerifyEmail();var div=document.createElement('div');div.innerHTML='<!--[if lt IE 10]><i></i><![endif]-->';var isIeLessThan10=(div.getElementsByTagName('i').length==1);if(isIeLessThan10){aeJS.settings['auth_window']=false;}
if(parseInt()===1&&aeJS.settings['mobile_detect'])aeJS.settings['auth_window']=false;if(aeJS.flow.step==='authenticate'){url=addParam(url,'return',absolutePath(aeJS.flow.return));if(JSON.parse(aeJS.settings['auth_window'])!==true)url=addParam(url,'auth_method','direct');if(!aeJS.isEmbed)url=addParam(url,'auth_referer','http://www.postmalone.com');authenticate(url);}else if(aeJS.flow.step==='remove'){if(JSON.parse(aeJS.settings['auth_window'])===true&&!aeJS.isEmbed){url=addParam(url,'ae_appid','2');url=addParam(url,'auth_method','window');$.post(url,aeJS.settings,function(auth_state){aeJS.user=auth_state.user;aeJS.events.onServiceRemoved.callHandler(auth_state.service,auth_state.user);});}else{url=addParam(url,'auth_method','direct');url=addParam(url,'return',absolutePath(aeJS.flow.return));location.href=url;}}else if(aeJS.flow.step==='logout'){if(JSON.parse(aeJS.settings['auth_window'])===true&&!aeJS.isEmbed){aeJS.trigger.logout();}else{url=addParam(url,'auth_method','direct');url=addParam(url,'return',absolutePath(aeJS.flow.return));location.href=url;}}else{if(aeJS.flow.step==='error'&&aeJS.settings['display_error_message']===false)return;flowURL=addParam('https://umg.theappreciationengine.com/framework/flow/4/'+aeJS.flow.step,'auth_url',url);flowURL=addParam(flowURL,'return',absolutePath(aeJS.flow.return));if(JSON.parse(aeJS.settings['auth_window'])===true||aeJS.isEmbed)flowURL=addParam(flowURL,'auth_method','window');if(JSON.parse(aeJS.settings['auth_window'])===true&&!aeJS.isEmbed){aeJS.modal.window.show(flowURL,aeJS.settings);}else{var cache_url=addParam(flowURL,'pre_cache',1);if(aeJS.isEmbed){cache_url=addParam(cache_url,'auth_method','window');}else{cache_url=addParam(cache_url,'auth_method','direct');}
$.post(cache_url,aeJS.settings,function(data){flowURL=addParam(flowURL,'cache_key',data);location.href=flowURL;});}}}});;if(!aeJS.isEmbed){flowURL='https://umg.theappreciationengine.com/framework/flow/4/prep';var cache_url=addParam(flowURL,'pre_cache',1);var cache_url=addParam(cache_url,'from','b85474c18298ed0a9398a4488659f2c1');$.post(cache_url,aeJS.settings,function(data){aeJSPrepped=true;aeJS.events.onLoaded.callHandler(aeJS);});}else{aeJSPrepped=true;}
if(typeof GetURLParameter('step')!=='undefined'){switch(GetURLParameter('step')){case'error':nextSteps({'state':'error','error':{'code':GetURLParameter('code'),'message':GetURLParameter('message')}});break;case'verify-email-ok':aeJS.self_destruct=function(e){if(e.type==='modal'&&e.state==='closed'){getAuthState();aeJS.events.onWindow.removeHandler(aeJS.self_destruct);}}
aeJS.events.onWindow.addHandler(aeJS.self_destruct);aeJS.settings['code']=GetURLParameter('code');aeJS.flow.step='verify-email-ok';aeJS.events.onFlow.callHandler(aeJS.flow);break;case'reset-password-ok':aeJS.self_destruct=function(e){if(e.type==='modal'&&e.state==='closed'){getAuthState();aeJS.events.onWindow.removeHandler(aeJS.self_destruct);}}
aeJS.events.onWindow.addHandler(aeJS.self_destruct);aeJS.settings['code']=GetURLParameter('code');aeJS.flow.step='reset-password-ok';aeJS.events.onFlow.callHandler(aeJS.flow);break;case'send-email-ok':aeJS.settings['code']=GetURLParameter('code');flowURL='https://umg.theappreciationengine.com/framework/flow/4/send-email-ok';var cache_url=addParam(flowURL,'pre_cache',1);var cache_url=addParam(cache_url,'from','b85474c18298ed0a9398a4488659f2c1');$.post(cache_url,aeJS.settings,function(auth_state){auth_state=JSON.parse(auth_state);getAuthState();aeJS.events.onEmailVerify.callHandler('verified',auth_state.verified);});break;case'remove-service':var service=GetURLParameter('service');aeJS.events.onServiceRemoved.callHandler(service,aeJS.user);break;}};}});}})();